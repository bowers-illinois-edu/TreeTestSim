% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_many_runs.R
\name{simulate_many_runs_DT}
\alias{simulate_many_runs_DT}
\title{Simulate the Family-Wise Error Rate (FWER) using a Data.table-based Tree with Alpha Options}
\usage{
simulate_many_runs_DT(
  n_sim,
  t,
  k,
  max_level,
  alpha,
  N_total,
  effect_size = 0.5,
  power_decay = TRUE,
  local_adj_p_fn = local_simes,
  return_details = FALSE,
  global_adj = "hommel",
  alpha_method = "fixed",
  final_global_adj = "none",
  multicore = FALSE,
  monotonicity = TRUE,
  ...
)
}
\arguments{
\item{n_sim}{Integer. The number of simulation replicates.}

\item{t}{Numeric in \eqn{[0,1]}. The probability that a leaf is non-null.}

\item{k}{Integer. The branching factor.}

\item{max_level}{Integer. The maximum level (depth) of the tree.}

\item{alpha}{Numeric. The nominal significance level.}

\item{N_total}{Numeric. The total sample size at the root.}

\item{effect_size}{Numeric. Cohen's d — the standardized effect size at
each non-null leaf. Together with \code{N_total} and the tree structure,
this determines power at every level.}

\item{power_decay}{Logical. If \code{TRUE} (default), non-null signal
strength decreases at deeper levels. If \code{FALSE}, root-level power
is used at all depths.}

\item{local_adj_p_fn}{Function. A function (e.g. \code{local_simes}) to adjust p-values at a node.}

\item{return_details}{Logical. Whether to return the full simulated data.table.}

\item{global_adj}{Character. The method to adjust the leaves (e.g. "hommel").}

\item{alpha_method}{Character. One of \code{"fixed"}, \code{"spending"}, \code{"investing"}.}

\item{final_global_adj}{Character. One of \code{"none"}, \code{"fdr"}, \code{"fwer"}.}

\item{multicore}{Logical. Whether to use multiple cores (via \code{parallel::mclapply}).}

\item{monotonicity}{Logical. TRUE if we require child nodes p-values to be
no larger than those of parent nodes. FALSE child nodes could have smaller
p-values.}

\item{...}{Additional arguments passed to \code{simulate_test_DT()}.}
}
\value{
A named numeric vector giving averaged error rates and discovery metrics across simulations.
}
\description{
Runs the hierarchical testing procedure on complete k-ary trees (generated via \code{generate_tree_DT()})
\code{n_sim} times and returns the estimated FWER. The user may choose whether to use a fixed \eqn{α},
\eqn{α}–spending, or a rudimentary \eqn{α}–investing scheme.
}
